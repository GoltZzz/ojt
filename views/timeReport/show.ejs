<%- layout('layouts/boilerplate') %>

<div class="container mt-4">
	<div class="row mb-4">
		<div class="col-md-8">
			<h2>Time Report Details</h2>
			<div class="card mb-3">
				<div class="card-body">
					<div class="row">
						<div class="col-md-6">
							<% if (timeReport.studentName) { %>
							<p><strong>Student:</strong> <%= timeReport.studentName %></p>
							<% } %> <% if (timeReport.internshipSite) { %>
							<p>
								<strong>Internship Site:</strong> <%= timeReport.internshipSite
								%>
							</p>
							<% } %>
							<p>
								<strong>Date:</strong> <%= new
								Date(timeReport.date).toLocaleDateString() %>
							</p>
							<p>
								<strong>Date Submitted:</strong> <%= new
								Date(timeReport.dateSubmitted).toLocaleDateString() %>
							</p>
							<% if (timeReport.status) { %>
							<p>
								<strong>Status:</strong>
								<span class="badge bg-success">Approved</span>
							</p>
							<% } %>
						</div>
						<div class="col-md-6">
							<p>
								<strong>Hours Worked:</strong> <%= timeReport.hoursWorked %>
							</p>
							<p><strong>Description:</strong> <%= timeReport.description %></p>
							<% if (timeReport.weekStartDate && timeReport.weekEndDate) { %>
							<p>
								<strong>Week Period:</strong>
								<%= new Date(timeReport.weekStartDate).toLocaleDateString() %> -
								<%= new Date(timeReport.weekEndDate).toLocaleDateString() %>
							</p>
							<% } %> <% if (timeReport.excelFile &&
							timeReport.excelFile.originalName) { %>
							<p>
								<strong>Excel File:</strong> <%=
								timeReport.excelFile.originalName %>
							</p>
							<% } %> <% if (timeReport.excelFile &&
							timeReport.excelFile.uploadDate) { %>
							<p>
								<strong>Upload Date:</strong> <%= new
								Date(timeReport.excelFile.uploadDate).toLocaleString() %>
							</p>
							<% } %> <% if (timeReport.summary &&
							timeReport.summary.totalHours) { %>
							<p>
								<strong>Total Hours:</strong> <%= timeReport.summary.totalHours
								%> hours
							</p>
							<% } %>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="col-md-4 text-end">
			<a href="/timereport" class="btn btn-secondary">
				<i class="fas fa-arrow-left"></i> Back to Time Reports
			</a>
		</div>
	</div>

	<!-- PDF Display Section -->
	<% if (timeReport.pdfFile) { %>
	<div class="card mb-4">
		<div class="card-header">
			<h5>Time Report Document (PDF)</h5>
		</div>
		<div class="card-body">
			<div class="mb-4">
				<div class="pdf-viewer mb-3">
					<iframe
						src="<%= timeReport.pdfFile.path %>"
						width="100%"
						height="600px"
						style="border: 1px solid #ddd; border-radius: 4px"
						title="Time Report PDF">
					</iframe>
				</div>
				<div class="document-download mt-3">
					<a
						href="<%= timeReport.pdfFile.path %>"
						class="btn btn-success"
						download>
						<i class="fas fa-download me-2"></i>Download PDF File
					</a>
					<% if (timeReport.excelFile && timeReport.excelFile.filename) { %>
					<a
						href="/uploads/excel/<%= timeReport.excelFile.filename %>"
						class="btn btn-primary ms-2"
						download>
						<i class="fas fa-download me-2"></i>Download Original Excel
					</a>
					<% } %>
					<small class="text-muted d-block mt-2">
						PDF Size: <%= (timeReport.pdfFile.size / 1024 / 1024).toFixed(2) %>
						MB
					</small>
				</div>
			</div>
		</div>
	</div>
	<% } else { %>
	<!-- Fallback for reports without PDF -->
	<div class="card mb-4">
		<div class="card-header">
			<h5>Time Report Document</h5>
		</div>
		<div class="card-body">
			<div class="alert alert-info">
				<i class="fas fa-info-circle me-2"></i>
				This time report was uploaded before PDF conversion was available. <% if
				(timeReport.excelFile && timeReport.excelFile.filename) { %>
				<br />
				<a
					href="/uploads/excel/<%= timeReport.excelFile.filename %>"
					class="btn btn-primary mt-2"
					download>
					<i class="fas fa-download me-2"></i>Download Excel File
				</a>
				<% } %>
			</div>
		</div>
	</div>
	<% } %>
</div>
